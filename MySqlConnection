const MySQL = require('mysql');


const DatabaseSettings = {
    host: 'localhost',
    user: 'user',
    password: 'password',
    database: 'databasename'
};


class MySqlConnection {

    constructor() {
        this.connection = null;
        this.connect();
    }

    connect() {
        if (this.connection) {
            console.log("There is an already opened connection.");
            return;
        }
        console.log("Creating a new connection to the database.");

        this.connection = MySQL.createConnection(DatabaseSettings);
    }

    disconnect() {
        if (this.connection) {
            console.log("Closing connection to the database.");
            this.connection.end();
            this.connection = null;
        } else {
            console.log("No connection to close.");
        }
    }

    query(sentence) {
        if (!this.connection) this.connect();
        
        return new Promise((resolve) => {
            this.connection.query(sentence, (error, response) => {
                if (error) throw error;
                return resolve(response);
            });
        });
    }
}

module.exports = MySqlConnection;
